<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
   <!--  Template for Pos Dashboard  -->
    <t t-name="PosDashboard">
       <div class="main-container" style="height: 100vh; overflow-y: auto; display: flex; flex-direction: column;">
          <link rel="stylesheet" href="/dashboard_pos/static/src/css/style.css"/>
          <div class="o_pos_dashboard_main p-3">
             <div class="oh_dashboards">
                <div class="container-fluid o_pos_dashboard">
                   <div class="row bg-white p-3 rounded">
                      <div class="col-4">
                         <label class="form-label w-100" for="start_date">Desde
                         <input type="date" id="start_date" name="start_date"
                                t-ref="start_date"
                                class="form-control"
                                t-att-value="state.start_date"
                                t-on-change="(ev) => this.onStartDateChange(ev)"/>
                         </label>
                      </div>
                       <div class="col-4">
                         <label class="form-label w-100" for="end_date">Hasta
                         <input type="date" id="end_date" name="end_date"
                                t-ref="end_date"
                                class="form-control"
                                t-att-value="state.end_date"
                                t-on-change="(ev) => this.onEndDateChange(ev)"/>
                         </label>
                      </div>
                       <!--                  <div class="col-4">-->
                       <!--                     <label class="form-check-label" for="grouping">-->
                       <!--                     Agrupado por-->
                       <!--                     </label>-->
                       <!--                     <select id="grouping-select" class="form-select" t-on-change="onGroupingChange">-->
                       <!--                        <option value="">Seleccionar</option>-->
                       <!--                        <option value="bodega" selected="selected">Bodega</option>-->
                       <!--                        <option value="usuario">Usuario</option>-->
                       <!--                        <option value="sector">Sector</option>-->
                       <!--                     </select>-->
                       <!--                  </div>-->
                   </div>
                    <!--               <div class="row justify-content-between my-4 p-3">-->
                    <!--                  &lt;!&ndash; Pedidos de hoy &ndash;&gt;-->
                    <!--                  <div class="col-lg-2 col-md-4 col-sm-6 mb-4">-->
                    <!--                     <div class="card p-3 text-center shadow-sm border-0">-->
                    <!--                        <div class="d-flex justify-content-center align-items-center mb-3">-->
                    <!--                           <div class="bg-primary text-white rounded-circle d-flex justify-content-center align-items-center"-->
                    <!--                              style="width: 50px; height: 50px;">-->
                    <!--                              <i class="fa fa-shopping-bag fs-3"></i>-->
                    <!--                           </div>-->
                    <!--                        </div>-->
                    <!--                        <h4 class="fw-bold">-->
                    <!--                           <t t-esc="state.today_sale"/>-->
                    <!--                        </h4>-->
                    <!--                        <p class="text-muted mb-0">Pedidos de hoy</p>-->
                    <!--                     </div>-->
                    <!--                  </div>-->
                    <!--                  &lt;!&ndash; Total Orders &ndash;&gt;-->
                    <!--                  <div class="col-lg-2 col-md-4 col-sm-6 mb-4">-->
                    <!--                     <div class="card p-3 text-center shadow-sm border-0">-->
                    <!--                        <div class="d-flex justify-content-center align-items-center mb-3">-->
                    <!--                           <div class="bg-warning text-white rounded-circle d-flex justify-content-center align-items-center"-->
                    <!--                              style="width: 50px; height: 50px;">-->
                    <!--                              <i class="fa fa-shopping-bag  fs-3"></i>-->
                    <!--                           </div>-->
                    <!--                        </div>-->
                    <!--                        <h4 class="fw-bold">-->
                    <!--                           <t t-esc="state.total_order_count"/>-->
                    <!--                        </h4>-->
                    <!--                        <p class="text-muted mb-0">Total Orders</p>-->
                    <!--                     </div>-->
                    <!--                  </div>-->
                    <!--                  &lt;!&ndash; Total Sales &ndash;&gt;-->
                    <!--                  <div class="col-lg-2 col-md-4 col-sm-6 mb-4">-->
                    <!--                     <div class="card p-3 text-center shadow-sm border-0">-->
                    <!--                        <div class="d-flex justify-content-center align-items-center mb-3">-->
                    <!--                           <div class="bg-success text-white rounded-circle d-flex justify-content-center align-items-center"-->
                    <!--                              style="width: 50px; height: 50px;">-->
                    <!--                              <i class="fa fa-shopping-cart fs-3"></i>-->
                    <!--                           </div>-->
                    <!--                        </div>-->
                    <!--                        <h4 class="fw-bold">-->
                    <!--                           <t t-esc="state.total_sale"/>-->
                    <!--                        </h4>-->
                    <!--                        <p class="text-muted mb-0">Total Sales</p>-->
                    <!--                     </div>-->
                    <!--                  </div>-->
                    <!--                  &lt;!&ndash; Sesiones &ndash;&gt;-->
                    <!--                  <div class="col-lg-2 col-md-4 col-sm-6 mb-4">-->
                    <!--                     <div class="card p-3 text-center shadow-sm border-0">-->
                    <!--                        <div class="d-flex justify-content-center align-items-center mb-3">-->
                    <!--                           <div class="bg-info text-white rounded-circle d-flex justify-content-center align-items-center"-->
                    <!--                              style="width: 50px; height: 50px;">-->
                    <!--                              <i class="fa fa-user fs-3"></i>-->
                    <!--                           </div>-->
                    <!--                        </div>-->
                    <!--                        <h4 class="fw-bold">-->
                    <!--                           <t t-esc="state.total_session"/>-->
                    <!--                        </h4>-->
                    <!--                        <p class="text-muted mb-0">Sesiones</p>-->
                    <!--                     </div>-->
                    <!--                  </div>-->
                    <!--                  &lt;!&ndash; Reembolsos &ndash;&gt;-->
                    <!--                  <div class="col-lg-2 col-md-4 col-sm-6 mb-4">-->
                    <!--                     <div class="card p-3 text-center shadow-sm border-0">-->
                    <!--                        <div class="d-flex justify-content-center align-items-center mb-3">-->
                    <!--                           <div class="bg-danger text-white rounded-circle d-flex justify-content-center align-items-center"-->
                    <!--                              style="width: 50px; height: 50px;">-->
                    <!--                              <i class="fa fa-undo fs-3"></i>-->
                    <!--                           </div>-->
                    <!--                        </div>-->
                    <!--                        <h4 class="fw-bold">-->
                    <!--                           <t t-esc="state.total_refund_count"/>-->
                    <!--                        </h4>-->
                    <!--                        <p class="text-muted mb-0">Reembolsos</p>-->
                    <!--                     </div>-->
                    <!--                  </div>-->
                    <!--               </div>-->
                </div>
             </div>
              <div class="container-fluid bg-light p-4">
                <!-- Filtros -->
                  <div class="row pb-4">
                   <div class="col-md-4">
                        <label class="form-label fw-bold">Seleccionar Usuario</label>
                       <div class="form-control">
                            <MultiRecordSelector
                                    resModel="state.model_search_user"
                                    resIds="state.selectedUserIds"
                                    update.bind="onUpdateSelectedUsers"
                                    placeholder="'Usuario'"/>
                        </div>
                    </div>
                      <div class="col-md-4">
                      <label class="form-label fw-bold">Seleccionar Bodega</label>
                          <div class="form-control">
                          <MultiRecordSelector
                                  resModel="state.model_search_warehouse"
                                  resIds="state.selectedWarehouseIds"
                                  update.bind="onUpdateSelectedWarehouse"
                                  placeholder="'Bodega'"/>
                        </div>
                   </div>
                      <div class="col-md-4">
                      <label class="form-label fw-bold">Seleccionar Sector</label>
                          <div class="form-control">
                          <MultiRecordSelector
                                  resModel="state.model_search_sector"
                                  resIds="state.selectedSectorIds"
                                  update.bind="onUpdateSelectedSector"
                                  placeholder="'Sector'"/>
                       </div>
                     </div>
                </div>
                  <!-- Tabla de datos más compacta -->
                  <div class="mb-2">
                    <button class="btn btn-primary" t-on-click="openColumnModal">Filtrar Columnas</button>
                </div>

                <div class="table-container bg-white" style="max-height: 400px; overflow-y: auto; position: relative;">
                    <table class="table-main table table-sm table-striped table-hover table-bordered text-center bg-white"
                           style="width: max-content;">
                        <thead class="bg-primary text-white small" style="position: sticky; top: 0; z-index: 2;">
                            <tr>
                                <th t-foreach="state.columnVisibility" t-as="col" t-key="col.id"
                                    t-att-class="col.visible ? '' : 'hidden-column'" class="py-1 px-2"
                                    t-att-data-column="col.id">
                                    <span t-esc="col.label"/>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="state.list_orders" t-as="order" t-key="order.id">
                                <tr class="small">
                                    <td t-foreach="state.columnVisibility" t-as="col" t-key="col.id"
                                        t-att-class="col.visible ? '' : 'hidden-column'" class="py-1 px-2">
                                        <t t-esc="order[col.id] || ''"/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    <div t-if="state.is_loading" class="text-center py-2">
                        <h1> Cargando más datos... </h1>
                    </div>
                </div>
             </div>
          </div>

           <t t-if="state.showColumnModal">
            <div class="modal fade show" style="display: block;" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Filtrar Columnas</h5>
                            <button type="button" class="close" t-on-click="closeColumnModal">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <button class="btn btn-success btn-sm mr-2"
                                        t-on-click="selectAllColumns">Marcar Todas</button>
                                <button class="btn btn-danger btn-sm"
                                        t-on-click="deselectAllColumns">Desmarcar Todas</button>
                            </div>
                            <div class="column-toggle d-flex flex-column gap-2">
                                <t t-foreach="state.columnVisibility" t-as="column" t-key="column.id">
                                    <label class="d-flex align-items-center">
                                        <input type="checkbox"
                                               t-att-checked="column.visible"
                                               t-att-data-column="column.id"
                                               t-on-change="onToggleColumn"/>
                                        <span class="ml-2"><t t-esc="column.label" /></span>
                                    </label>
                                </t>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary"
                                    t-on-click="closeColumnModal">Cerrar</button>
                        </div>
                    </div>
                </div>
            </div>
               <div class="modal-backdrop fade show" t-on-click="closeColumnModal"></div>
        </t>
           <!-- Sección de Resultados después de la tabla -->
           <div class="container-fluid bg-light rounded shadow-sm bg-white m-3 p-5" style="width: 1400px">
         <div class="row g-1">
            <!-- Primera fila -->
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Venta Efectivo</label>
                 <input type="text" class="form-control fw-bold text-center"
                        t-att-value="(state.sale_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Venta Tarjeta</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.sale_card || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Venta Cheque/Transferencia</label>
                 <input type="text" class="form-control fw-bold text-warning text-center"
                        t-att-value="(state.sale_check_transfer || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Venta Crédito</label>
                 <input type="text" class="form-control fw-bold text-dark text-center"
                        t-att-value="(state.sale_credit || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <!--            <div class="col-lg-2 col-md-4 col-sm-6">-->
             <!--               <label class="form-label fw-bold">Efectivo</label>-->
             <!--               <input type="text" class="form-control fw-bold text-warning text-center" t-att-value="(state.total_cash || 0).toFixed(2)" readonly="readonly" />-->
             <!--            </div>-->
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)NC Efectivo</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.note_credit_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <!-- Segunda fila -->
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)NC Tarjeta</label>
                 <input type="text" class="form-control text-warning text-center"
                        t-att-value="(state.note_credit_card || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)NC Cheque/Transferencia</label>
                 <input type="text" class="form-control text-warning text-center"
                        t-att-value="(state.note_credit_check_transfer || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)NC Crédito</label>
                 <input type="text" class="form-control text-warning text-center"
                        t-att-value="(state.note_credit_credit || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Alc. Ef. Tarjeta</label>
                 <input type="text" class="form-control text-success text-center"
                        t-att-value="(state.scope_card || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Alc. Ef. Cheque/Transferencia</label>
                 <input type="text" class="form-control text-danger text-center"
                        t-att-value="(state.scope_check_transfer || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Alc. Ef. Crédito</label>
                 <input type="text" class="form-control text-center" t-att-value="(state.scope_credit || 0).toFixed(2)"
                        readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Alc. Ef. Anticipo</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.scope_advance || 0).toFixed(2)" readonly="readonly"/>
            </div>

             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)Alc. Ef. Tarjeta</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.note_credit_scope_card || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)Alc. Ef. Cheque/Transferencia</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.note_credit_scope_check_transfer || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)Alc. Ef. Crédito</label>
                 <input type="text" class="form-control fw-bold text-danger text-center"
                        t-att-value="(state.note_credit_scope_credit || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Total Alcances</label>
                 <input type="text" class="form-control text-success text-center"
                        t-att-value="(state.total_scope || 0).toFixed(2)" readonly="readonly"/>
            </div>

             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Retenciones</label>
                 <input type="text" class="form-control text-center" t-att-value="(state.retention || 0).toFixed(2)"
                        readonly="readonly"/>
            </div>


             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">(-)Anticipo Gen.</label>
                 <input type="text" class="form-control text-success text-center"
                        t-att-value="(state.note_credit_advance_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Anticipo Util</label>
                 <input type="text" class="form-control text-success text-center"
                        t-att-value="(state.advance_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Total Efectivo</label>
                 <input type="text" class="form-control text-danger text-center"
                        t-att-value="(state.total_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <!-- Cuarta fila -->
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Arqueo Efectivo</label>
                 <input type="text" class="form-control text-warning text-center"
                        t-att-value="(state.counting_cash || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Faltante</label>
                 <input type="text" class="form-control text-success text-center"
                        t-att-value="(state.missing || 0).toFixed(2)" readonly="readonly"/>
            </div>
             <div class="col-lg-2 col-md-4 col-sm-6">
               <label class="form-label fw-bold">Sobrante</label>
                 <input type="text" class="form-control text-danger text-center"
                        t-att-value="(state.surplus || 0).toFixed(2)" readonly="readonly"/>
            </div>


         </div>
               <!-- Botones de acción -->
               <div class="row mt-3 text-center p-3">
            <div class="col-md-4">
<!--               <button class="btn btn-dark w-100">Check FC</button>-->
            </div>
                   <div class="col-md-4">
<!--               <button class="btn btn-dark w-100">Check NC</button>-->
            </div>
                   <div class="col-md-4 text-end">
               <button class="btn btn-secondary w-100" t-on-click="downloadExcel">
                  <i class="fa fa-book fs-3"></i>
                   Descargar Reporte Excel
               </button>
                <button type="button" class="btn btn-secondary w-100" t-on-click="downloadPdf">
                <i class="fa fa-book fs-3"></i>
                   Descargar Reporte PDF
                </button>
            </div>
         </div>
      </div>
       </div>
   </t>
</templates>