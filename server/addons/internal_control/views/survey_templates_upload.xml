<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Template para preguntas de tipo upload_file -->
    <template id="question_page_upload_answer"
              inherit_id="survey.question_container">
        <xpath expr="//div[@role='alert']" position="before">
            <t t-if="question.question_type == 'upload_file'">
                <t t-call="internal_control.multi_upload_file"/>
            </t>
        </xpath>
    </template>
    
    <!-- Template para el componente de subida de archivos -->
    <template id="multi_upload_file">
        <div class="o_survey_upload_container">
            <div class="o_survey_upload_box" id="survey_upload_box">
                <div class="o_survey_upload_box_header">Subir Archivos</div>
                <br/>
                <div class="o_survey_upload_box_body">
                    <input type="file" class="o_survey_upload_file"
                           data-oe-data=""
                           data-oe-file_name=""
                           t-att-data-question-type="question.question_type"
                           t-att-name="question.id"
                           t-att-multiple="question.upload_multiple_file"
                           accept="image/*"
                    />
                </div>
            </div>
            <br/>
            <div id="fileList" class="o_survey_upload_list"/>
            <t t-if="question.upload_multiple_file == False">
                <div class="o_survey_upload_note">Nota: Solo puedes subir un archivo.
                </div>
            </t>
            <t t-if="question.upload_multiple_file == True">
                <div class="o_survey_upload_note">Nota: Puedes subir múltiples archivos.
                </div>
            </t>
        </div>
    </template>
    
    <!-- Template para mostrar respuestas de archivos en página de impresión -->
    <template id="survey_page_print_upload_answer"
              inherit_id="survey.survey_page_print">
        <xpath expr="//div[hasclass('o_survey_question_error')]" position="before">
            <t t-if="question.question_type == 'upload_file'">
                <t t-call="internal_control.multi_upload_answer"/>
            </t>
        </xpath>
    </template>
    
    <!-- Template para mostrar archivos adjuntos en respuestas -->
    <template id="multi_upload_answer">
        <t t-if="answer_lines.value_file_data_ids">
            <div>
                <t t-foreach="answer_lines.value_file_data_ids" t-as="attachment">
                    <a t-attf-href="/web/content/{{ attachment.id }}?download=true">
                        <i class="fa fa-download"/>
                        <t t-esc="attachment.name"/>
                    </a>
                    <br/>
                </t>
            </div>
        </t>
    </template>

    <template id="survey_already_answered" name="Survey Already Answered">
        <t t-call="web.layout">
            <t t-set="head">
                <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
                <meta name="description" content="Encuesta ya respondida"/>
            </t>
            <div class="container mt-4">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header bg-warning text-dark">
                                <h3 class="card-title mb-0">
                                    <i class="fa fa-exclamation-triangle"></i>
                                    Encuesta ya respondida
                                </h3>
                            </div>
                            <div class="card-body text-center">
                                <div class="alert alert-info">
                                    <h4>¡Gracias por tu participación!</h4>
                                    <p>Esta encuesta ya ha sido completada anteriormente.</p>
                                    <p><strong>Encuesta:</strong> <t t-esc="survey.title"/></p>
                                    <p><strong>Fecha de respuesta:</strong> <t t-esc="assignment.create_date"/></p>
                                </div>
                                <div class="mt-4">
                                    <a href="/" class="btn btn-primary">
                                        <i class="fa fa-home"></i> Volver al inicio
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo> 