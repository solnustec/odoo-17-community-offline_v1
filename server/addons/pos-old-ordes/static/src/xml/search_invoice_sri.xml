<templates id="template" xml:space="preserve">
    <t t-name="point_of_sale.TicketScreen" t-inherit="point_of_sale.TicketScreen"
       t-inherit-mode="extension"
       owl="1">
        <xpath expr="//div[contains(@class, 'buttons')]" position="replace">
            <div class="buttons d-flex gap-2">
                <t t-if="!ui.isSmall">
                    <div class="buttons d-flex gap-2">
                        <button t-if="!ui.isSmall" class="discard btn btn-lg btn-light"
                                t-on-click="() => this.closeTicketScreen()">
                            <span class="search-icon">
                                <i class="fa fa-angle-double-left"/>
                            </span>
                            <t t-if="!ui.isSmall">
                                Back
                            </t>
                        </button>
                        <button t-if="allowNewOrders" class="highlight btn btn-lg btn-primary"
                                t-on-click="() => this.onCreateNewOrder()">New Order</button>
                    </div>
                    <button class="highlight btn btn-lg btn-primary"
                            t-on-click="() => this.btnSriSearch()">Consultar facturas</button>
                </t>
            </div>
        </xpath>
    </t>

    <t t-name="pos-old-ordes.PopupSri" owl="1">
        <div class="popup popup-CheckInfoPopup" style="max-width: 700px;">
            <div class="modal-header" style="color: black !important;">
                <h4 class="modal-title">INGRESO DE FACTURAS</h4>
            </div>
            <div class="modal-body">
                <div t-if="state.statusCreateOrder" class="alert alert-success mb-3">
                        <t t-esc="state.message_status"/>
                </div>
                <div class="text-start mb-2">
                    <label for="claveAccesoComprobante">C√©dula / R.U.C del cliente:</label>
                </div>
                <div class="d-flex align-items-center mb-4">
                    <input class="form-control me-2" id="claveAccesoComprobante" type="text"
                           placeholder="9999999999999"/>
                    <button t-on-click="btnSriSearchInput" class="btn btn-info" t-att-disabled="state.loading">
                        <t t-if="state.loading">Cargando...</t>
                        <t t-if="!state.loading">Buscar</t>
                    </button>
                </div>

                <!-- üî• TABLA DE FACTURAS üî• -->
                <div t-if="state.invoices.length > 0" class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                    <table class="table table-striped table-bordered mb-0">
                        <thead style="position: sticky; top: 0; background: white; z-index: 1;">
                            <tr>
                                <th>Cliente</th>
                                <th>Fecha</th>
                                <th>Serie-Secuencia</th>
                                <th>Total</th>
                                <th>Acci√≥n</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="state.invoices" t-as="invoice" t-key="invoice.ID">
                                <tr>
                                    <td><t t-esc="state.client_name"/></td>
                                    <td><t t-esc="invoice.date"/></td>
                                    <td><t t-esc="invoice.SERIESEC"/></td>
                                    <td>$<t t-esc="invoice.TOTAL.toFixed(2)"/></td>
                                    <td>
                                        <button class="highlight btn btn-primary"
                                            t-on-click="() => this.onSelectInvoiceTable(invoice)">Registrar</button>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>


                <t t-if="state.loading">
                    <div class="d-flex justify-content-center my-4">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                    </div>
                </t>
            </div>



            <div t-if="responseMessage">
                <h3>Respuesta del SRI</h3>
            </div>
            <footer class="footer modal-footer">

                <button t-on-click="cancel" class="button cancel btn btn-lg btn-secondary" t-att-disabled="state.loading">
                    <t t-if="state.loading">Cerrar</t>
                    <t t-if="!state.loading">Cerrar</t>
                </button>
            </footer>
        </div>
    </t>
</templates>
